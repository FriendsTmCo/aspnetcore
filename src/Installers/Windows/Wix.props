<Project>

  <PropertyGroup>
    <!-- Ugly hack - Wix doesn't accept build numbers larger than 65535, and AzDo's BuildIds are larger than that.
         The largest we ever got on TeamCity was 31363, so we want to be in the range of 31364 - 65535. To achieve this we take the
         AzDO build number modulo 34172 (65545 - 31363 = 34172), and add 31364 to that to give us a number in the desired range. -->
    <InstallerBuildNumber>$(BuildNumber)</InstallerBuildNumber>
    <InstallerBuildNumberModulo Condition="'$(BuildNumber)' != 't000'">$([MSBuild]::Modulo($(BuildNumber), 34172))</InstallerBuildNumberModulo>
    <InstallerBuildNumber Condition="'$(BuildNumber)' != 't000'">$([MSBuild]::Add($(InstallerBuildNumberModulo), 31364))</InstallerBuildNumber>
    <Version>$(AspNetCoreMajorVersion).$(AspNetCoreMinorVersion).$(AspNetCorePatchVersion).$(InstallerBuildNumber)</Version>
    <Configuration Condition="'$(Configuration)' == ''">Release</Configuration>
    <Platform Condition="'$(Platform)' == ''">x64</Platform>
    <Lang Condition="'$(Lang)' == ''">ENU</Lang>
    <Cultures>en-US</Cultures>
    <BaseOutputPath>$(RootOutputPath)bin/$(Configuration)/installers/</BaseOutputPath>
    <OutputPath>$(BaseOutputPath)</OutputPath>
  </PropertyGroup>

  <!-- Additional parameters for Light/Candle-->
  <PropertyGroup>
    <LinkerAdditionalOptions>-fv</LinkerAdditionalOptions>
    <SuppressIces>ICE61</SuppressIces>
    <SuppressWarnings>1033</SuppressWarnings>
  </PropertyGroup>

  <PropertyGroup>
    <DefineSolutionProperties>false</DefineSolutionProperties>

    <!-- Namespace used to generate stable UUID3 GUIDs for MSI ProductCode, etc. DO NOT CHANGE THESE. -->
    <HostingBundleNamespaceGuid>E1FD1271-E0F0-4B8B-B4BE-01F2EBA58F4E</HostingBundleNamespaceGuid>
    <SharedFrameworkNamespaceGuid>C43D5520-11B3-4D62-B6FE-5D6840B04101</SharedFrameworkNamespaceGuid>
  </PropertyGroup>

  <PropertyGroup>
    <DefineConstants>$(DefineConstants);files=$(MSBuildThisFileDirectory)files</DefineConstants>
    <DefineConstants>$(DefineConstants);Version=$(Version)</DefineConstants>
    <DefineConstants>$(DefineConstants);Culture=$(Cultures)</DefineConstants>
    <DefineConstants>$(DefineConstants);MajorVersion=$(AspNetCoreMajorVersion)</DefineConstants>
    <DefineConstants>$(DefineConstants);MinorVersion=$(AspNetCoreMinorVersion)</DefineConstants>
    <DefineConstants>$(DefineConstants);PackageVersion=$(PackageVersion)</DefineConstants>
    <GenerateNupkgPowershellScript>$(RepositoryRoot)\src\Installers\Windows\GenerateNugetPackageWithMsi.ps1</GenerateNupkgPowershellScript>
  </PropertyGroup>

</Project>